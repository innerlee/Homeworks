\section{Problem 1}~\label{sec:prob1}

Let $\vu_t:=\mW_{hz}\vh_t+\vb_z$.
Then $\vz_t=\softmax(\vu_t)$.
Using formula for softmax, we have
\begin{equation}
    \frac{\partial z_{t,i}}{\partial u_{t,j}} = \Ibb(i=j)z_{t,j}-z_{t,i}z_{t,j}.
\end{equation}

\begin{equation}
    \frac{\partial u_{t,l}}{\partial W_{hz,ij}}
        = \frac{\partial \big(\sum_s W_{hz,ls}h_{t,s}+b_{z,l}\big)}{\partial W_{hz,ij}}
        = \Ibb(i=l)h_{t,j}
\end{equation}

\begin{equation}
    \frac{\partial L}{\partial z_{t,i}}= -\frac{\Ibb(i=y_t)}{z_{t,i}}
\end{equation}

Use these equations, we have

\begin{equation}
\begin{split}
    \frac{\partial L}{\partial W_{hz,ij}}
        &= \sum_t \frac{\partial L}{\partial \vz_t} \frac{\partial \vz_t}{\partial W_{hz,ij}} \\
        &= \sum_{t,k} \frac{\partial L}{\partial z_{t,k}} \frac{\partial z_{t,k}}{\partial W_{hz,ij}} \\
        &= \sum_{t,k,l} \frac{\partial L}{\partial z_{t,k}} \frac{\partial z_{t,k}}{\partial u_{t,l}}\frac{\partial u_{t,l}}{\partial W_{hz,ij}} \\
        &= \sum_{t,k} \frac{\partial L}{\partial z_{t,k}} \frac{\partial z_{t,k}}{\partial u_{t,i}}h_{t,j} \\
        &= \sum_{t} -\frac{h_{t,j}}{z_{t,y_t}} \frac{\partial z_{t,{y_t}}}{\partial u_{t,i}} \\
\end{split}
\end{equation}

Now compute derivatives for $\mW_{hh}$.
Let $\vv_t=$

\begin{equation}
\begin{split}
    \frac{d \tanh(s)}{d s}
        &= 1 - \tanh(s)^2
\end{split}
\end{equation}

\begin{equation}
\begin{split}
    \frac{\partial L}{\partial W_{hh}}
        &= \sum_t \frac{\partial L}{\partial \vh_t} \frac{\partial \vh_t}{\partial W_{hh}} \\
        &= \sum_{t,i} \frac{\partial L}{\partial h_{t,i}} \frac{\partial h_{t,i}}{\partial W_{hh}} \\
\end{split}
\end{equation}
